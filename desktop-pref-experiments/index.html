<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-deep-dives/desktop/desktop-pref-experiments" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Desktop Pref Experiments | Experimenter Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://experimenter.info/desktop-pref-experiments"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Desktop Pref Experiments | Experimenter Docs"><meta data-rh="true" name="description" content="As of Firefox 107, Nimbus supports experiments that set preferences on Desktop."><meta data-rh="true" property="og:description" content="As of Firefox 107, Nimbus supports experiments that set preferences on Desktop."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://experimenter.info/desktop-pref-experiments"><link data-rh="true" rel="alternate" href="https://experimenter.info/desktop-pref-experiments" hreflang="en"><link data-rh="true" rel="alternate" href="https://experimenter.info/desktop-pref-experiments" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.bb172d27.css">
<link rel="preload" href="/assets/js/runtime~main.5ab7efff.js" as="script">
<link rel="preload" href="/assets/js/main.a8034749.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Experimenter Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-dark.svg" alt="Experimenter Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Mozilla Experimentation and Feature Delivery</b></a></div><div class="navbar__items navbar__items--right"><a href="https://experimenter.services.mozilla.com/nimbus/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Nimbus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://mozilla-hub.atlassian.net/wiki/spaces/PXI/pages/426934273/Nimbus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Confluence<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/mozilla/experimenter-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/">Welcome</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/whats-news/2024-Q1">What&#x27;s Newsletter</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/access">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/workflow/overview">Experimentation Workflow</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/deep-dives/jetstream/overview">Deep Dives</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/deep-dives/jetstream/overview">Jetstream</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/bucketing">Data topics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/desktop-enroll-locally">Desktop topics</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/desktop-enroll-locally">Desktop Local Experiment Iteration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/desktop-incident-response">Launching Incident Response Pref Flips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/desktop-pref-experiments">Desktop Pref Experiments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/desktop-targeting-debug">Desktop Targeting debug</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/mobile-behavioral-targeting">Mobile topics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/deep-dives/experimenter/branches-page">Experimenter topics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/client-sdk-states-and-lifecycle">Specifications</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cookbook/fml/fml-cookbook">Experimentation Cookbook</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/faq/general-faq">FAQ</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/integration-tests">Additional Links</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Deep Dives</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Desktop topics</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Desktop Pref Experiments</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Desktop Pref Experiments</h1></header><p>As of Firefox 107, Nimbus supports experiments that set preferences on Desktop.
Unlike Normandy, Nimbus cannot set arbitrary preferences; instead, the
preferences that may be set are determined by the feature manifest.</p><p>Each variable in a Nimbus feature can set a single pref of any type.</p><p>NB: Support for JSON variables was added in Firefox 126. The value of the pref
will be <code>JSON.stringify(value)</code>.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Danger, Will Robinson!</div><div class="admonitionContent_S0QG"><p>Prefs are complicated and it is easy to shoot yourself in the foot when using them if
you&#x27;re not cautious. The Nimbus team has prepared some guidance about using
prefs in your feature:</p><p>If you do not actually <em>need</em> to use a pref in your feature, we recommend that
you do not use one and instead read directly from the Nimbus API (via
<code>NimbusFeatures.myFeature.getVariable(&quot;var&quot;)</code> /
<code>NimbusFeatures.myFeature.getAllVariables()</code>).</p><p>If you <em>must</em> use a pref, then you must be careful about all writers to that
pref. Please read <a href="#user-preference-changes">this section</a> for a detailed
explanation of
pref writing interactions in Nimbus. We recommend that no other code write to
that pref.</p><p>Finally, we advise against instructing users to edit the pref via
<code>about:config</code>. This has a knock-on effect of normalizing users interacting with
complex &quot;under the hood&quot; settings which can be taken advantage of by malicious
actors. In addition, manually changing some prefs that are otherwise managed by
client code can violate invariants and force clients into confusing or
unpredicted scnearios.</p><p>If you&#x27;ve read to the end of this and aren&#x27;t scared off, please read <a href="#pref-branches">this
section</a> on which branch your feature should write to.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pref-branches">Pref branches<a href="#pref-branches" class="hash-link" aria-label="Direct link to Pref branches" title="Direct link to Pref branches">​</a></h2><p>Each variable using <code>setPref</code> must specify which branch will be written to. There are two branches,
each with its trade-offs:</p><dl><dt>The default branch</dt><dd>The default branch is where Firefox&#x27;s default pref values come from.<p>  This branch <em>is not</em> persisted to disk and so there will be a time
period during startup before Nimbus has finished initializing where default
pref values will not represent the current experiment state.</p><p>  You may want to use this branch if your code distinguishes from user branch
values versus default branch values.</p></dd><dt>The user branch</dt><dd>The user branch is where user&#x27;s configuration choices are stored (e.g., when changing settings via <code>about:preferences</code> or <code>about:config</code>).<p>  This branch <em>is</em> persisted to disk and loaded early during startup,
before Nimbus is initialized. Additionally, if a pref has a value on both the
default and user branches the user branch value will take precedence (e.g.,</p><code>Services.prefs.getBoolPref(&quot;foo.bar.baz&quot;)</code> will attempt to read from the user branch first).</dd></dl><p>If your feature configuration needs to be available early at startup (e.g., so
that Gecko internals can be initialized properly) you will have to use the user
branch.</p><p>Nimbus startup is triggered asynchronously after the UI has been shown
(technically after <code>sessionstore-windows-restored</code>) or 5 seconds after
<code>browser-before-ui-startup</code> (whichever comes first). Therefore, if your feature
controls whether or not some amount of UI is shown in the browser chrome (e.g.,
whether a button shows on the toolbar or not), you likely will want to use the
user branch.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Respecting User Choice</div><div class="admonitionContent_S0QG"><p>It is important to remember that writing to prefs on the user branch can
<strong>overwrite user choices</strong>.</p><p>Experimenter can automatically exclude users that have changed prefs controlled
by your feature. To enable this behaviour, check the &quot;Prevent enrollment if
users have changed any prefs set by this experiment&quot; checkbox on the Branches
page of your experiment. If you use this feature, you likely want to enable
&quot;Sticky Enrollment&quot; on the audience page as well to prevent unexpected
unenrollments.</p><p>You may also want to use this feature if you are writing to the default pref
branch and any user branch overrides would cause breakage result in incorrect
analysis.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-your-feature-in-experimenter">Configuring Your Feature in Experimenter<a href="#configuring-your-feature-in-experimenter" class="hash-link" aria-label="Direct link to Configuring Your Feature in Experimenter" title="Direct link to Configuring Your Feature in Experimenter">​</a></h2><p>If you are configuring an experiment you should include the same prefs <strong>in
every branch of your experiment</strong>. This protects your experiment from being
impacted by user pref changes across all branches.</p><p>For example, let&#x27;s consider the following feature:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">feature</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">variables</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> boolean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">setPref</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Defaults to false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">pref</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> myFeature.enabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">branch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> user</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">optionalFeatureEnabled</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> boolean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">setPref</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Defaults to false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">pref</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> myFeature.optional.enabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">branch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> user</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we have an experiment with three branches:</p><ol><li><strong>Control</strong></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li><strong>Treatment A</strong></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;enabled&quot;: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li><strong>Treatment B</strong></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;enabled&quot;: true,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;optionalFeatureEnabled&quot;: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Nimbus only registers pref listeners for variables controlled by the current
branch. So if the user is enrolled in the <strong>Control</strong> branch Nimbus will not
listen for any pref changes. In the <strong>Treatment A</strong> branch  Nimbus will listen
for changes to <code>myFeature.enabled</code>. In the <strong>Treatment B</strong> branch Nimbus will
listen to changes to both <code>myFeature.enabled</code> and <code>myFeature.optional.enabled</code>.</p><p>It is therefore possible for a user to be in the <strong>Control</strong> branch with
<code>myFeature.enabled</code> set to true and it is also possible for a user to tbe in
<strong>Treatment A</strong> branch and have <code>myFeature.optional.enabled</code> set to true.</p><p>The proper way to set up this experiment is therefore as follows:</p><ol><li><strong>Control</strong></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;enabled&quot;: false,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;optionalFeatureEnabled&quot;: false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li><strong>Treatment A</strong></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;enabled&quot;: true,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;optionalFeatureEnabled&quot;: false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li><strong>Treatment B</strong></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;enabled&quot;: true,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;optionalFeatureEnabled&quot;: true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="experiments-vs-rollouts">Experiments vs Rollouts<a href="#experiments-vs-rollouts" class="hash-link" aria-label="Direct link to Experiments vs Rollouts" title="Direct link to Experiments vs Rollouts">​</a></h2><p>Users can be enrolled in an experiment and rollout for the same feature. If both
an experiment and rollout set a variable that sets a pref, then the experiment
will take precedence. If the user unenrolls from the experiment, then the pref
will be set to the value specified in the rollout.</p><p>When the user is no longer enrolled in either an experiment or a rollout setting
a given pref, then it will be reset to its original value at the time of the
first enrollment, with some caveats:</p><ul><li>If the pref is set on the default branch (see <a href="#pref-branches">below</a>) and the
pref was not set before enrollment, then the pref will not change until the
next restart. This is due to a technical limitation: default branch values
cannot be cleared.</li><li>If the pref is set on the user branch and the pref was not set before
enrollment, then the pref will be cleared and will be no longer available.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="unenrollment-from-pref-experiments">Unenrollment from Pref Experiments<a href="#unenrollment-from-pref-experiments" class="hash-link" aria-label="Direct link to Unenrollment from Pref Experiments" title="Direct link to Unenrollment from Pref Experiments">​</a></h2><p>Normally Nimbus will only unenroll from experiments and rollouts when we check
for new recipes (periodically or after startup). During that check, Nimbus will
unenroll if:</p><ul><li>the experiment or rollout is no longer present on Remote Settings (reported as
<code>recipe-not-seen</code> in telemetry);</li><li>the experiment or rollout has a targeting expression that is no longer true
(reported as <code>targeting-mismatch</code>);</li><li>the rollout no longer matches bucketing (reported <code>bucketing</code>).</li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Including prefs in targeting expressions</div><div class="admonitionContent_S0QG"><p>If your experiment or rollout includes preference checks in its targeting
expression then it may unexpectedly unenroll or prevent a rollout or experiment
on the same feature from enrolling.</p><p>Experimenter can automatically exclude users that have changed prefs controlled
by your feature. If your feature writes to the user branch and uses this feature
(the &quot;Prevent enrollment if users have changed any prefs set by this experiment&quot;
checkbox on the branches page), you <strong>must</strong> enable &quot;sticky enrollment&quot; on the
Audience Page. Otherwise your experiment will automatically unenroll the next
time Nimbus evaluates targeting.</p></div></div><p>Pref Experiments can unenroll for additional reasons:</p><ul><li>the experiment or rollout sets a pref and that pref changes (either by a user
making a change in <code>about:config</code> or client code using the pref API);</li><li>the feature manifest changed sufficiently; or</li><li>Nimbus enrolled in an <a href="/desktop-incident-response">Incident Response Pref Flip</a> that set the
same pref.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="unexpected-preference-changes">Unexpected Preference Changes<a href="#unexpected-preference-changes" class="hash-link" aria-label="Direct link to Unexpected Preference Changes" title="Direct link to Unexpected Preference Changes">​</a></h3><p>If a user is enrolled in an experiment or rollout that sets a pref and that pref
changes, the user will be unenrolled from the experiment (or rollout). This
includes both changes made by the user and changes in code. Experiment runners
should be careful to ensure there is no code in tree that will modify prefs they
are experimenting on, otherwise their populations may get spuriously unenrolled.</p><p>The new value of the preference will be persisted.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="manifest-changes">Manifest Changes<a href="#manifest-changes" class="hash-link" aria-label="Direct link to Manifest Changes" title="Direct link to Manifest Changes">​</a></h3><p>Some changes to the feature manifest may result in unenrollment from an active
experiment:</p><ul><li>The feature being removed.</li><li>A variable that is currently setting a pref is removed.</li><li>A variable that is currently setting a pref either changes the pref it is
setting or no longer sets a pref (i.e., its <code>setPref</code> value changes or is
removed).</li></ul><p>It should be noted that unenrollment for these reasons will only occur when the
user is enrolled in a pref-setting experiment. If a feature specifies both
pref-setting and non-pref setting variables, then changes to the manifest will
not result in unenrollment if the active experiment does not have any values for
pref-setting variables.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="conflicts-with-incident-response-pref-flips">Conflicts with Incident Response Pref Flips<a href="#conflicts-with-incident-response-pref-flips" class="hash-link" aria-label="Direct link to Conflicts with Incident Response Pref Flips" title="Direct link to Conflicts with Incident Response Pref Flips">​</a></h3><p>If a user is enrolled in a setPref experiment/rollout and then enrolls in an
<a href="/desktop-incident-response">incident response pref flip</a>, they will be unenrolled from the
setPref experiment/rollout. This will result in an unenrollment event
(<a href="https://dictionary.telemetry.mozilla.org/apps/firefox_desktop/metrics/nimbus_events_unenrollment" target="_blank" rel="noopener noreferrer">glean</a>, <a href="https://probes.telemetry.mozilla.org/?search=unenroll&amp;view=detail&amp;probeId=event%2Fnormandy.unenroll%23unenroll" target="_blank" rel="noopener noreferrer">legacy</a>) being submitted with the
following data:</p><table><thead><tr><th>Glean Field</th><th>Legacy Field</th><th>Description</th></tr></thead><tbody><tr><td><code>reason</code></td><td><code>reason</code></td><td>The string <code>&quot;prefFlips-conflict&quot;</code></td></tr><tr><td><code>conflicting_slug</code></td><td><code>conflictingSlug</code></td><td>The slug of the experiment that caused the unenrollment.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="restrictions-with-fallback-prefs">Restrictions with Fallback Prefs<a href="#restrictions-with-fallback-prefs" class="hash-link" aria-label="Direct link to Restrictions with Fallback Prefs" title="Direct link to Restrictions with Fallback Prefs">​</a></h2><p>Variables may not specify both a <code>fallbackPref</code> and a <code>setPref</code>.</p><p>Fallback prefs and set prefs are mutually exclusive. That is, If any variable in
any feature specifies a pref as a fallback pref, no variable may set that
variable as a set pref and vice versa.</p><p>These restrictions are enforced at build time.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="example-feature">Example Feature<a href="#example-feature" class="hash-link" aria-label="Direct link to Example Feature" title="Direct link to Example Feature">​</a></h2><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">my-feature</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> A description of my feature</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> whoami@mozilla.com</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">hasExposure</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">variables</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> A variable setting a boolean pref to enable a feature.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> boolean</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">setPref</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">branch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> user</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">pref</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> my_feature.enabled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> A variable setting a string pref to determine some name.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">setPref</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">branch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> user</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">pref</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> my_feature.name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> A variable setting an integer pref to determine some count.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> int</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">setPref</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">branch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">pref</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> my_feature.count</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/mozilla/experimenter-docs/edit/main/docs/deep-dives/desktop/desktop-pref-experiments.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/desktop-incident-response"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Launching Incident Response Pref Flips</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/desktop-targeting-debug"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Desktop Targeting debug</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pref-branches" class="table-of-contents__link toc-highlight">Pref branches</a></li><li><a href="#configuring-your-feature-in-experimenter" class="table-of-contents__link toc-highlight">Configuring Your Feature in Experimenter</a></li><li><a href="#experiments-vs-rollouts" class="table-of-contents__link toc-highlight">Experiments vs Rollouts</a></li><li><a href="#unenrollment-from-pref-experiments" class="table-of-contents__link toc-highlight">Unenrollment from Pref Experiments</a><ul><li><a href="#unexpected-preference-changes" class="table-of-contents__link toc-highlight">Unexpected Preference Changes</a></li><li><a href="#manifest-changes" class="table-of-contents__link toc-highlight">Manifest Changes</a></li><li><a href="#conflicts-with-incident-response-pref-flips" class="table-of-contents__link toc-highlight">Conflicts with Incident Response Pref Flips</a></li></ul></li><li><a href="#restrictions-with-fallback-prefs" class="table-of-contents__link toc-highlight">Restrictions with Fallback Prefs</a></li><li><a href="#example-feature" class="table-of-contents__link toc-highlight">Example Feature</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Mozilla Corporation</div></div></div></footer></div>
<script src="/assets/js/runtime~main.5ab7efff.js"></script>
<script src="/assets/js/main.a8034749.js"></script>
</body>
</html>