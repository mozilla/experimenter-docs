"use strict";(self.webpackChunkexperimenter_docs=self.webpackChunkexperimenter_docs||[]).push([[2048],{4137:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>d});var r=n(7294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},m=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,s=e.mdxType,i=e.originalType,l=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=p(n),h=s,d=u["".concat(l,".").concat(h)]||u[h]||c[h]||i;return n?r.createElement(d,a(a({ref:t},m),{},{components:n})):r.createElement(d,a({ref:t},m))}));function d(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var i=n.length,a=new Array(i);a[0]=h;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[u]="string"==typeof e?e:s,a[1]=o;for(var p=2;p<i;p++)a[p]=n[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},9890:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var r=n(7462),s=(n(7294),n(4137));const i={id:"missing_exposures",title:"Missing Exposure-based Analysis?",slug:"/missing-exposure"},a=void 0,o={unversionedId:"deep-dives/data/missing_exposures",id:"deep-dives/data/missing_exposures",title:"Missing Exposure-based Analysis?",description:'In a Nimbus experiment, not every enrolled client actually experiences the experimental intervention or treatment. We refer to "experiencing the experimental treatment" as exposure. For example, in a messaging experiment, some enrolled users do not meet the conditions to be shown the message. As another example, some experimental treatments require the user to restart their browser to take effect, so users who do not restart do not experience the treatment. Calculating results based on all enrolled users, when many users are not exposed, results in a diluted estimate of the treatment impact. For the highest precision, experiments should be configured with an Exposure Signal, which allows the analysis system to determine which enrolled users were exposed. See this page for more info including interpreting different bases.',source:"@site/docs/deep-dives/data/missing_exposures.md",sourceDirName:"deep-dives/data",slug:"/missing-exposure",permalink:"/missing-exposure",draft:!1,editUrl:"https://github.com/mozilla/experimenter-docs/edit/main/docs/deep-dives/data/missing_exposures.md",tags:[],version:"current",frontMatter:{id:"missing_exposures",title:"Missing Exposure-based Analysis?",slug:"/missing-exposure"},sidebar:"sidebar",previous:{title:"Bucketing",permalink:"/bucketing"},next:{title:"Desktop Local Experiment Iteration",permalink:"/desktop-enroll-locally"}},l={},p=[{value:"Configuring experiments for exposure-based analysis",id:"configuring-experiments-for-exposure-based-analysis",level:2},{value:"Configuring exposures post-hoc",id:"configuring-exposures-post-hoc",level:3},{value:"What if no telemetry exists which can be proxied for exposure?",id:"what-if-no-telemetry-exists-which-can-be-proxied-for-exposure",level:4},{value:"Preparing future experiments for exposure-based analysis",id:"preparing-future-experiments-for-exposure-based-analysis",level:3}],m={toc:p},u="wrapper";function c(e){let{components:t,...i}=e;return(0,s.kt)(u,(0,r.Z)({},m,i,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,'In a Nimbus experiment, not every enrolled client actually experiences the experimental intervention or treatment. We refer to "experiencing the experimental treatment" as ',(0,s.kt)("inlineCode",{parentName:"p"},"exposure"),". For example, in a messaging experiment, some enrolled users do not meet the conditions to be shown the message. As another example, some experimental treatments require the user to restart their browser to take effect, so users who do not restart do not experience the treatment. Calculating results based on all enrolled users, when many users are not exposed, results in a ",(0,s.kt)("em",{parentName:"p"},"diluted estimate of the treatment impact"),". For the highest precision, experiments should be configured with an ",(0,s.kt)("em",{parentName:"p"},"Exposure Signal"),", which allows the analysis system to determine which enrolled users were exposed. See ",(0,s.kt)("a",{parentName:"p",href:"/deep-dives/jetstream/overview#enrollment-vs-exposure"},"this page")," for more info including interpreting different bases."),(0,s.kt)("p",null,"If you see missing results like those shown in the image below, then"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"The client did not call Nimbus's record exposure API (",(0,s.kt)("a",{parentName:"li",href:"/desktop-feature-api#recordexposureevent"},"desktop")," and ",(0,s.kt)("a",{parentName:"li",href:"/fml-spec#recording-exposure"},"mobile"),")."),(0,s.kt)("li",{parentName:"ol"},"A ",(0,s.kt)("inlineCode",{parentName:"li"},"ExposureSignal")," was not defined in this experiment's ",(0,s.kt)("a",{parentName:"li",href:"/deep-dives/jetstream/configuration#defining-exposure-signals"},"custom analysis configuration"),".")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"An image of the Nimbus UI showing results when exposures are missing. The results show zero clients enrolled and that the system is unable to calculate results",src:n(9046).Z,width:"2678",height:"1196"})),(0,s.kt)("h2",{id:"configuring-experiments-for-exposure-based-analysis"},"Configuring experiments for exposure-based analysis"),(0,s.kt)("h3",{id:"configuring-exposures-post-hoc"},"Configuring exposures post-hoc"),(0,s.kt)("p",null,"If the experiment is live or finished, then the only option is to define an ",(0,s.kt)("inlineCode",{parentName:"p"},"ExposureSignal")," as a custom config (see point 2 above). In this approach, we tell the automated analysis system which telemetry probe represents exposure for this experiment. Note that this must be a telemetry probe that was collected while the experiment was live. For assistance with this step, contact your supporting data scientist through the experiment's DS Jira ticket or ask in ",(0,s.kt)("a",{parentName:"p",href:"https://mozilla.slack.com/archives/CF94YGE03"},"#ask-experimenter"),"."),(0,s.kt)("admonition",{title:"Dangers with custom signals",type:"warning"},(0,s.kt)("p",{parentName:"admonition"},"Exposure is the point in time ",(0,s.kt)("em",{parentName:"p"},"immediately prior")," to recieving the treatment. We cannot use any post-treatment telemetry as the definition of exposure as that risks creating a biased comparison and results in non-causal inference. For example, an experiment in which the treatment gets a message to suggest using a new feature. In that experiment, exposure is ",(0,s.kt)("em",{parentName:"p"},"being shown a message")," (treatment branch) or ",(0,s.kt)("em",{parentName:"p"},"would have been shown a message")," (control branch). Exposure ",(0,s.kt)("strong",{parentName:"p"},"is not")," ",(0,s.kt)("em",{parentName:"p"},"using the new feature"),". If we compare users who used the feature we'll be comparing users who discovered the feature organically (control branch) against a treatment branch containing organic discoverers and users who tried the feature out as a result of seeing the message.")),(0,s.kt)("h4",{id:"what-if-no-telemetry-exists-which-can-be-proxied-for-exposure"},"What if no telemetry exists which can be proxied for exposure?"),(0,s.kt)("p",null,"In that case, fall back on enrollments-based analysis (click the ",(0,s.kt)("inlineCode",{parentName:"p"},"enrollments")," radio button in the Analysis Basis selector) and see the ",(0,s.kt)("a",{parentName:"p",href:"#enrollments-vs-exposures-analysis"},"section on interpretation discussion")," below. Additionally, aim to have future experiments configured for exposures-based analysis."),(0,s.kt)("h3",{id:"preparing-future-experiments-for-exposure-based-analysis"},"Preparing future experiments for exposure-based analysis"),(0,s.kt)("p",null,"For experiments that have not yet launched, it is preferred to implement exposures client-side by calling the appropriate method from the Nimbus SDK (see point 1 above). Once implemented, these events will get picked up by the automated analysis system, so no custom analysis configuration is required."),(0,s.kt)("admonition",{title:"Common mistake: exposures missing in control branches",type:"info"},(0,s.kt)("p",{parentName:"admonition"},"It is important to record exposures events in all treatment branches. Sometimes, this can be complex to do for a control group where the exposure is a lack of intervention. For example, a control group that does not get a new feature or does not get a message. In this case, we need to record telemetry ",(0,s.kt)("em",{parentName:"p"},"at the point in time the users would have received the intervention but for the fact that they were allocated to the control group"),". In the message case, we need the messaging system to record an event that a message ",(0,s.kt)("em",{parentName:"p"},"would have been shown")," but for the system to also not actually show the message.")),(0,s.kt)("p",null,"An example of an experiment that has exposure events only for the treatment branch, and thus cannot do exposure-based analysis:"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Missing exposures in the control branch",src:n(3427).Z,width:"1354",height:"540"})))}c.isMDXComponent=!0},9046:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/missing_exposures_analysis-6a1606169692bc68a873deb961fafa04.png"},3427:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/missing_exposures_control_branch-6def9417af176bca4283c753cfa5f574.png"}}]);