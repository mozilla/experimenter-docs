"use strict";(self.webpackChunkexperimenter_docs=self.webpackChunkexperimenter_docs||[]).push([[4297],{4137:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),p=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),m=p(n),d=a,h=m["".concat(l,".").concat(d)]||m[d]||c[d]||r;return n?i.createElement(h,s(s({ref:t},u),{},{components:n})):i.createElement(h,s({ref:t},u))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,s=new Array(r);s[0]=d;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[m]="string"==typeof e?e:a,s[1]=o;for(var p=2;p<r;p++)s[p]=n[p];return i.createElement.apply(null,s)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3734:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var i=n(7462),a=(n(7294),n(4137));const r={id:"population_representativeness",title:"Population Representativeness",slug:"/data-analysis/data-topics/population_representativeness"},s=void 0,o={unversionedId:"data-analysis/data-topics/population_representativeness",id:"data-analysis/data-topics/population_representativeness",title:"Population Representativeness",description:'It is desirable for the group enrolled in a delivery (experiment, (micro)survey, etc.) to be a representative sample of the targeted population. A lack of representativeness could indicate selection biases that would invalidate learnings. We term a lack of representativeness as a "representativeness failure". This page documents common causes of representativeness failures. For simplicity, this document will use the term "experiment", but the same issues apply to non-experiment deliveries (surveys, rollouts, etc.).',source:"@site/docs/data-analysis/data-topics/population_representativeness.md",sourceDirName:"data-analysis/data-topics",slug:"/data-analysis/data-topics/population_representativeness",permalink:"/data-analysis/data-topics/population_representativeness",draft:!1,editUrl:"https://github.com/mozilla/experimenter-docs/edit/main/docs/data-analysis/data-topics/population_representativeness.md",tags:[],version:"current",frontMatter:{id:"population_representativeness",title:"Population Representativeness",slug:"/data-analysis/data-topics/population_representativeness"},sidebar:"sidebar",previous:{title:"Preenrollment Bias",permalink:"/data-analysis/data-topics/preenrollment_bias"},next:{title:"Telemetry",permalink:"/data-analysis/telemetry"}},l={},p=[{value:"Synchronization",id:"synchronization",level:2},{value:"Enrollment",id:"enrollment",level:2},{value:"Exposure",id:"exposure",level:2}],u={toc:p},m="wrapper";function c(e){let{components:t,...n}=e;return(0,a.kt)(m,(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"It is desirable for the group enrolled in a delivery (experiment, (micro)survey, etc.) to be a ",(0,a.kt)("em",{parentName:"p"},"representative sample"),' of the targeted population. A lack of representativeness could indicate selection biases that would invalidate learnings. We term a lack of representativeness as a "representativeness failure". This page documents common causes of representativeness failures. For simplicity, this document will use the term "experiment", but the same issues apply to non-experiment deliveries (surveys, rollouts, etc.).'),(0,a.kt)("p",null,"At a high level, the delivery funnel (steps to be shown an experimental variant) has the following phases:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Synchronization: delivering the recipe (experiment definition) to the client"),(0,a.kt)("li",{parentName:"ol"},"Enrollment: evaluating the targeting criteria and conditionally recording enrollment"),(0,a.kt)("li",{parentName:"ol"},"Exposure: triggering the display or execution of the experiment variant.")),(0,a.kt)("p",null,"At each phase there is the possibility of introducing lack of representativeness, either purposefully or accidentally."),(0,a.kt)("p",null,'Note: in general, if there is telemetry it is "positive telemetry" on the situations below, i.e., telemetry is emitted when a condition is met. Telemetry is not emitted when a condition is not met. This can make diagnosing issues challenging.'),(0,a.kt)("h2",{id:"synchronization"},"Synchronization"),(0,a.kt)("p",null,"When an experiment is launched, knowledge of that experiment must be transmitted to the client. In general, clients receive Nimbus recipes by connecting to Remote Settings, a globally distributed CDN. Some common causes of failure to synchronize are:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Low Activity:")," a client needs to be sufficiently active in order to trigger a refresh of its internal recipe cache. As a result, low activity users may be less likely to synchronize and thus less likely to be sampled. See ",(0,a.kt)("a",{parentName:"li",href:"https://docs.google.com/document/d/1-TgZcuiA3UDZ30Vo2Ot7d_Lyqncx7AaBhAqq8GxlP8M/edit#heading=h.g5mbvod6ojw6"},"this document")," for more info. "),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Network Issues:")," clients need to make a successful connection to the Remote Settings CDN. Structural challenges may arise here: users on certain mobile networks or in certain locales may have difficulty connecting, and thus less likely to be sampled."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Out-of-date Versions:")," Nimbus generally supports a rolling version window and aims to support the most recent 12-18 months of versions. Users running versions older than that may not be eligible.",(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Certificate Expiration:")," the Remote Settings certificate expires periodically and when this happens, users on old Firefox versions (with the old certificate) lose the ability to connect to Remote Settings, and thus lose the ability to synchronize."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Reliance on New Nimbus Functionality:")," a delivery may require certain Nimbus functionality that was made available in a certain release. Users on older versions will lack that functionality, and thus not be eligible.")))),(0,a.kt)("h2",{id:"enrollment"},"Enrollment"),(0,a.kt)("p",null,'Nimbus provides a broad ability to "target" a delivery to a certain population. While this is useful, by design it can induce representativeness failures, depending on the execution. For example, an experiment that targets users in Europe will not enroll users in North America. As a result, attempts to generalize learnings may be fraught.'),(0,a.kt)("p",null,"This section primarily aims to document ",(0,a.kt)("em",{parentName:"p"},"unexpected")," representativeness failures (those not explicitly introduced by targeting criteria) that can cause structural biases in which users are enrolled into an experiment."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Cross-experiment Dependencies:")," explicitly targeting or explicitly excluding another delivery can introduce unexpected representativeness failures.",(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Location Example:")," Suppose a prior experiment (Experiment-A) was run on 50% of ",(0,a.kt)("inlineCode",{parentName:"li"},"en-US")," locale users. Another experiment, Experiment-B is configured to explicitly exclude the users in Experiment-A, but otherwise has no locale-based targeting criteria. Relative to the general population, Experiment-B will be underweight ",(0,a.kt)("inlineCode",{parentName:"li"},"en-US")," users."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Time Example:")," Suppose a prior experiment (Experiment-A) was run a year ago on new users. Experiment B wishes to follow-up on Experiment-A and explicitly targets Experiment-A. However, note that the Experiment-A cohort are no longer new users. Many users will have churned, and any remaining will have been using the product for a year."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Namespace Rollovers:")," In the case of multiple small experiments on a single Feature, Nimbus's sampling mechanism is robust such that successive experiments sample different hashes of the user space, so that the targeting from prior experiments does not impact the sampled population for subsequent experiemnts. However, it is possible for this to be violated if a large, live experiment is running when the ",(0,a.kt)("a",{parentName:"li",href:"/data-analysis/data-topics/bucketing#namespace-rollovers"},"namespace is exhausted"),".",(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},"If an experiment samples 10% of ",(0,a.kt)("inlineCode",{parentName:"li"},"en-US")," users and the namespace ",(0,a.kt)("em",{parentName:"li"},"does not")," rollover, a subsequent experiment also requesting 10% of ",(0,a.kt)("inlineCode",{parentName:"li"},"en-US")," users will get 10%."),(0,a.kt)("li",{parentName:"ol"},"If an experiment samples 10% of ",(0,a.kt)("inlineCode",{parentName:"li"},"en-US")," locale users and the namespace ",(0,a.kt)("em",{parentName:"li"},"does")," rollover, a subsequent experiment also requesting 10% of ",(0,a.kt)("inlineCode",{parentName:"li"},"en-US")," users will get roughly 9% (10% of the 90% not enrolled + 0% of the 10% enrolled)."),(0,a.kt)("li",{parentName:"ol"},"As below, Features with co-enrollment are not subject to the issues with namespace rollovers. This includes the mobile messaging system, and thus surveys and microsurveys."))))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Multi-feature Experiments:")," a client can (generally) only be enrolled in one experiment per Feature (application surface) at a time. A Multi-Feature experiment is one that runs on multiple application surfaces simultaneously (e.g., the experiment turns on new functionality and uses the messaging system to inform the user of the feature). A client is (generally) eligible for a multi-feature experiment if they are not in an experiment on ",(0,a.kt)("em",{parentName:"li"},"any")," of the individual Features.",(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},'Some Features are configured to allow "co-enrollment", that is, enrollment in multiple experiments and/or rollouts simultaneously, such as the mobile messaging system. These Features are not subject to the above restriction.')))),(0,a.kt)("h2",{id:"exposure"},"Exposure"),(0,a.kt)("p",null,"Exposure is the step of applying the experimental treatment to the user. The criteria for triggering an exposure can vary depending on the Feature or Feature-specific criteria (such as message triggering logic) which may be arbitrarily precise. Some common examples include:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"User Actions:")," sometimes, a user action is necessary to trigger exposure, such as opening a menu. In this case, users who do not take the action will not be exposed to the treatment. For example, if a survey invitation is shown on the new-tab page, only users who visit the new tab may be shown the invitation. As another example, on Desktop some features take effect only after an application restart. Users who do not restart the app will not experience the new variant."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Messaging Triggers:"),' the desktop and mobile messaging systems allow for messages to be configured using trigger points and trigger criteria. Users whose actions do not result in the appropriate trigger point will not experience the message. For example, a trigger point might be "opened the new tab" and the trigger criteria is "12-24 hours after install". Only users who open the new tab during the appropriate window, are eligible to be shown the message.',(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},"Note that the desktop messaging system offers further control over message display through the use of message groups. These can be used to set temporal caps on message frequency, but are, by-design, cross experiment. So if a prior experiment displays a message in a message group, subsequent experiments are blocked from that message group until the cap has expired.")))))}c.isMDXComponent=!0}}]);