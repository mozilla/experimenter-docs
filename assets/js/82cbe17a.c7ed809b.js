"use strict";(self.webpackChunkexperimenter_docs=self.webpackChunkexperimenter_docs||[]).push([[5930],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>c});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=i.createContext({}),p=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},g="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),g=p(n),d=r,c=g["".concat(l,".").concat(d)]||g[d]||m[d]||a;return n?i.createElement(c,o(o({ref:t},u),{},{components:n})):i.createElement(c,o({ref:t},u))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[g]="string"==typeof e?e:r,o[1]=s;for(var p=2;p<a;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},437:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var i=n(7462),r=(n(7294),n(3905));const a={id:"ios-custom-targeting",title:"Adding new targeting attributes to iOS",slug:"/ios-custom-targeting"},o="Adding new targeting attributes to iOS",s={unversionedId:"workflow/implementing/mobile-targeting/ios-custom-targeting",id:"workflow/implementing/mobile-targeting/ios-custom-targeting",title:"Adding new targeting attributes to iOS",description:"This page demonstrates how to add new targeting attributes to iOS, enabling experiment creators more specific targeting.",source:"@site/docs/workflow/implementing/mobile-targeting/ios-custom-targeting.md",sourceDirName:"workflow/implementing/mobile-targeting",slug:"/ios-custom-targeting",permalink:"/ios-custom-targeting",draft:!1,editUrl:"https://github.com/mozilla/experimenter-docs/edit/main/docs/workflow/implementing/mobile-targeting/ios-custom-targeting.md",tags:[],version:"current",frontMatter:{id:"ios-custom-targeting",title:"Adding new targeting attributes to iOS",slug:"/ios-custom-targeting"},sidebar:"sidebar",previous:{title:"Adding new targeting attributes to Android",permalink:"/android-custom-targeting"},next:{title:"Onboarding Feature for Android",permalink:"/onboarding/onboarding-feature-android"}},l={},p=[{value:"Adding the attribute to the application",id:"adding-the-attribute-to-the-application",level:2},{value:"How to add a new attribute",id:"how-to-add-a-new-attribute",level:3},{value:"Adding the attribute on experimenter",id:"adding-the-attribute-on-experimenter",level:2},{value:"Examples",id:"examples",level:2}],u={toc:p},g="wrapper";function m(e){let{components:t,...n}=e;return(0,r.kt)(g,(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"adding-new-targeting-attributes-to-ios"},"Adding new targeting attributes to iOS"),(0,r.kt)("p",null,"This page demonstrates how to add new targeting attributes to iOS, enabling experiment creators more specific targeting.\nFor more general documentation on targeting custom audiences, check out ",(0,r.kt)("a",{parentName:"p",href:"/workflow/implementing/custom-audiences"},"the custom audiences docs")),(0,r.kt)("h2",{id:"adding-the-attribute-to-the-application"},"Adding the attribute to the application"),(0,r.kt)("p",null,"The Nimbus SDK exposes a new ",(0,r.kt)("inlineCode",{parentName:"p"},"customTargetingAttributes")," parameter in its initializer that is a ",(0,r.kt)("inlineCode",{parentName:"p"},"[String:String]")," map. We can take advantage of this parameter to pass in new targeting attributes without modifying the Nimbus SDK at all."),(0,r.kt)("admonition",{type:"warning"},(0,r.kt)("p",{parentName:"admonition"},"A current limitation is that both the key and the value of the targeting attribute are ",(0,r.kt)("strong",{parentName:"p"},"strings"),". Please reach out to the Nimbus SDK team for any targeting attributes that require integer comparison, or any other richer ",(0,r.kt)("inlineCode",{parentName:"p"},"JEXL")," expressions that cannot be done with strings.")),(0,r.kt)("p",null,"Note that since we need to add the targeting attribute on the client code, the attribute changes will have to ride the trains before they are available for targeting."),(0,r.kt)("h3",{id:"how-to-add-a-new-attribute"},"How to add a new attribute"),(0,r.kt)("p",null,"In ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/tarikeshaq/firefox-ios/blob/add-first-run-targeting/Client/Application/AppDelegate%2BExperiments.swift#L17"},"AppDelegate+Experiments.swift")," the map ",(0,r.kt)("inlineCode",{parentName:"p"},"customTargetingAttributes")," will be used to add custom targeting. Simply add a new key-value pair to the map and it will be available for targeting. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-swift"},'Experiments.customTargetingAttributes =  ["isFirstRun": "\\(isFirstRun)", "newTargetingAttributeName": "targetingAttributeValue"]\n')),(0,r.kt)("h2",{id:"adding-the-attribute-on-experimenter"},"Adding the attribute on experimenter"),(0,r.kt)("p",null,"After the targeting attribute is ready on the app, you will need to modify experimenter to allow creating experiments that target the attribute you created. Follow the instructions on ",(0,r.kt)("a",{parentName:"p",href:"/workflow/implementing/custom-audiences#how-to-add-a-new-custom-audience"},"the custom audiences page")," to add the new targeting on experimenter."),(0,r.kt)("admonition",{type:"warning"},(0,r.kt)("p",{parentName:"admonition"},"The targeting ",(0,r.kt)("inlineCode",{parentName:"p"},"JEXL")," expression on experimenter ",(0,r.kt)("strong",{parentName:"p"},"must")," use the same name as the key given to the SDK. For example, for targeting users on their first run, the app defines a key-value pair, with key ",(0,r.kt)("inlineCode",{parentName:"p"},"isFirstRun"),". The experimenter expression must use the same name (i.e ",(0,r.kt)("inlineCode",{parentName:"p"},"isFirstRun"),")")),(0,r.kt)("h2",{id:"examples"},"Examples"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Check out this PR for an example on how to add new targeting attributes for iOS: ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/mozilla-mobile/firefox-ios/pull/8952"},"https://github.com/mozilla-mobile/firefox-ios/pull/8952")),(0,r.kt)("li",{parentName:"ul"},"Check out this PR for an example on how to add new targeting attributes to experimenter: ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/mozilla/experimenter/pull/6257"},"https://github.com/mozilla/experimenter/pull/6257"))))}m.isMDXComponent=!0}}]);