"use strict";(globalThis.webpackChunkexperimenter_docs=globalThis.webpackChunkexperimenter_docs||[]).push([[1e3],{5680(e,t,n){n.d(t,{xA:()=>c,yg:()=>m});var a=n(6540);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,l=e.originalType,s=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),d=p(n),m=i,g=d["".concat(s,".").concat(m)]||d[m]||u[m]||l;return n?a.createElement(g,o(o({ref:t},c),{},{components:n})):a.createElement(g,o({ref:t},c))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var l=n.length,o=new Array(l);o[0]=d;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:i,o[1]=r;for(var p=2;p<l;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1094(e,t,n){n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>p});var a=n(8168),i=(n(6540),n(5680));const l={id:"localization",title:"Localization",slug:"/workflow/localization"},o=void 0,r={unversionedId:"workflow/localization",id:"workflow/localization",title:"Localization",description:"How to localize experiment content using Pontoon, including multi-locale and single-locale workflows.",source:"@site/docs/workflow/localization.md",sourceDirName:"workflow",slug:"/workflow/localization",permalink:"/workflow/localization",draft:!1,editUrl:"https://github.com/mozilla/experimenter-docs/edit/main/docs/workflow/localization.md",tags:[],version:"current",frontMatter:{id:"localization",title:"Localization",slug:"/workflow/localization"},sidebar:"sidebar",previous:{title:"Configuring",permalink:"/workflow/configuring"},next:{title:"Testing",permalink:"/workflow/testing"}},s={},p=[{value:"Multi-Locale Recipe (Firefox 113 and Later)",id:"multi-locale-recipe-firefox-113-and-later",level:2},{value:"Set Up the Experiment",id:"set-up-the-experiment",level:3},{value:"Request Translation (Multi-Locale)",id:"request-translation-multi-locale",level:3},{value:"Issue Title",id:"issue-title",level:4},{value:"Information About the Experiment",id:"information-about-the-experiment",level:4},{value:"Deadline",id:"deadline",level:4},{value:"Retrieve Translated Content (Multi-Locale)",id:"retrieve-translated-content-multi-locale",level:3},{value:"Single-Locale Recipe",id:"single-locale-recipe",level:2},{value:"Request Translation (Single-Locale)",id:"request-translation-single-locale",level:3},{value:"List of Locales",id:"list-of-locales",level:4},{value:"Content to Translate",id:"content-to-translate",level:4},{value:"Retrieve Translated Content (Single-Locale)",id:"retrieve-translated-content-single-locale",level:3}],c={toc:p};function u(e){let{components:t,...n}=e;return(0,i.yg)("wrapper",(0,a.A)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.yg)("p",null,"How to localize experiment content using Pontoon, including multi-locale and single-locale workflows."),(0,i.yg)("admonition",{type:"info"},(0,i.yg)("p",{parentName:"admonition"},"Localization support for Nimbus experiments is constantly improving. Make sure to check this page again before setting up new experiments.")),(0,i.yg)("p",null,"Using the process described in this page it\u2019s possible to localize content for experiments outside of the standard product release cycle. There are two different workflows, depending on the experiment\u2019s target:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Firefox Desktop 113 and later versions include support for ",(0,i.yg)("a",{parentName:"li",href:"#multi-locale-recipe-firefox-113-and-later"},"multi-locale recipes"),"."),(0,i.yg)("li",{parentName:"ul"},"For older versions of Firefox Desktop, and potentially other platforms, there is a manual process using ",(0,i.yg)("a",{parentName:"li",href:"#single-locale-recipe"},"single-locale recipes"),".")),(0,i.yg)("p",null,"In most cases, the translation will be performed through ",(0,i.yg)("a",{parentName:"p",href:"https://pontoon.mozilla.org/"},"Pontoon"),", the internal Translation Management System (TMS) in use at Mozilla."),(0,i.yg)("img",{src:"/img/workflow/localization_workflow.png",alt:"Overview of localization workflow",class:"img-xl-center"}),(0,i.yg)("p",null,"The standard process expects content to be translated and reviewed by ",(0,i.yg)("strong",{parentName:"p"},"community"),", which ensures higher quality but requires longer turn-around. On a case by case basis, it will be possible to consider alternative sources (internal staff, external paid vendors, or machine translation)."),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"PROVIDER"),(0,i.yg)("th",{parentName:"tr",align:null},"QUALITY"),(0,i.yg)("th",{parentName:"tr",align:null},"SPEED"),(0,i.yg)("th",{parentName:"tr",align:null},"SLA"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Community (Pontoon)"),(0,i.yg)("td",{parentName:"tr",align:null},"High"),(0,i.yg)("td",{parentName:"tr",align:null},"Low (1-2 weeks)"),(0,i.yg)("td",{parentName:"tr",align:null},"N/A")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Pretranslation (Pontoon)",(0,i.yg)("sup",{parentName:"td",id:"fnref-1"},(0,i.yg)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))),(0,i.yg)("td",{parentName:"tr",align:null},"Medium-Low"),(0,i.yg)("td",{parentName:"tr",align:null},"High (minutes without review)"),(0,i.yg)("td",{parentName:"tr",align:null},"100%")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Paid vendors"),(0,i.yg)("td",{parentName:"tr",align:null},"Medium-High"),(0,i.yg)("td",{parentName:"tr",align:null},"Medium-High (48h or more)"),(0,i.yg)("td",{parentName:"tr",align:null},"100%")))),(0,i.yg)("p",null,"The localization EPM assigned to the issue will be able to advise on the best choice."),(0,i.yg)("h2",{id:"multi-locale-recipe-firefox-113-and-later"},"Multi-Locale Recipe (Firefox 113 and Later)"),(0,i.yg)("h3",{id:"set-up-the-experiment"},"Set Up the Experiment"),(0,i.yg)("p",null,"Each localizable string is set up in the experiment using a ",(0,i.yg)("inlineCode",{parentName:"p"},"$l10n")," object. The object properties are:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"\xecd"),": a unique identifier for the string. It can only contain letters, numbers, and ",(0,i.yg)("inlineCode",{parentName:"li"},"-"),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"text"),": the text of the string."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"comment"),": a comment used to provide more context to localizers.")),(0,i.yg)("p",null,"An identifier can be reused throughout the recipe, but it always has to be associated to the same text."),(0,i.yg)("p",null,"Here\u2019s an example of string definition in a recipe fragment:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json"},'"title": {\n  "raw": {\n    "$l10n": {\n      "id": "welcome-text",\n      "text": "Welcome to Firefox",\n      "comment": "welcome text"\n    }\n},\n')),(0,i.yg)("p",null,"In order to move forward with the translation request:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"The experiment needs to be set up as a ",(0,i.yg)("strong",{parentName:"li"},"draft")," in Experimenter, with all localizable strings defined in each branch as ",(0,i.yg)("inlineCode",{parentName:"li"},"$l10n")," objects."),(0,i.yg)("li",{parentName:"ul"},"The list of locales needs to be selected in the ",(0,i.yg)("inlineCode",{parentName:"li"},"Audience")," section."),(0,i.yg)("li",{parentName:"ul"},"The ",(0,i.yg)("inlineCode",{parentName:"li"},"Localization")," checkbox in the ",(0,i.yg)("inlineCode",{parentName:"li"},"Branches")," section can remain deselected at this stage.")),(0,i.yg)("p",null,(0,i.yg)("a",{parentName:"p",href:"https://github.com/mozilla-l10n/nimbus-l10n/#automation-to-extract-strings-from-experiment-recipe"},"Automation")," in the l10n repository will use Experimenter\u2019s API to find the draft, extract the list of requested locales and the strings to translate (by searching for ",(0,i.yg)("inlineCode",{parentName:"p"},"$l10n")," objects)."),(0,i.yg)("h3",{id:"request-translation-multi-locale"},"Request Translation (Multi-Locale)"),(0,i.yg)("p",null,"Once the experiment is set up as a draft and the content has been finalized, to initiate a translation request ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/mozilla-l10n/nimbus-l10n/issues/new?assignees=flodolo&template=new_translation_multilocale_recipe.yaml"},"create a new issue here"),". Use the ",(0,i.yg)("strong",{parentName:"p"},"Submit new issue")," button at the bottom of the page after filling all mandatory fields in the form; this will generate a standard GitHub issue, so it will still be possible to add comments later."),(0,i.yg)("h4",{id:"issue-title"},"Issue Title"),(0,i.yg)("p",null,"Include a descriptive name for the experiment, e.g. ",(0,i.yg)("inlineCode",{parentName:"p"},"PiP alternative dismiss message"),"."),(0,i.yg)("h4",{id:"information-about-the-experiment"},"Information About the Experiment"),(0,i.yg)("p",null,"Provide as much information as possible about the experiment, including links to the experiment brief and mock-ups of the UI where applicable. This information will be used by the Localization EPM assigned to the issue to prepare the file for translation, and provide context to localizers."),(0,i.yg)("h4",{id:"deadline"},"Deadline"),(0,i.yg)("p",null,"Provide the desired deadline (optional). Unless there is pre-established availability from staff to localize the content, expect about 7 days to complete the process from request to delivery. The time required might change depending on the amount of text to translate."),(0,i.yg)("h3",{id:"retrieve-translated-content-multi-locale"},"Retrieve Translated Content (Multi-Locale)"),(0,i.yg)("p",null,"Once translation has been completed, automation will add a comment in the original issue with the translation in JSON format. This data can be copied directly in the ",(0,i.yg)("inlineCode",{parentName:"p"},"Localization")," field in Experimenter (",(0,i.yg)("inlineCode",{parentName:"p"},"Branches")," section). Note that GitHub provides a convenient copy button, when hovering over a code block."),(0,i.yg)("p",null,"The JSON will look like this:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "en-US": {\n    "message-text": "This is an example localized experiment",\n    "ok-button-text": "OK",\n    "welcome-text": "Welcome to Firefox"\n  },\n  "fr": {\n    "message-text": "Ceci est un exemple d\u2019exp\xe9rience localis\xe9e",\n    "ok-button-text": "D\u2019accord",\n    "welcome-text": "Bienvenue dans Firefox"\n  }\n}\n')),(0,i.yg)("h2",{id:"single-locale-recipe"},"Single-Locale Recipe"),(0,i.yg)("p",null,"This solution has a few limitations:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"To target multiple locales (e.g. ",(0,i.yg)("inlineCode",{parentName:"li"},"de")," and ",(0,i.yg)("inlineCode",{parentName:"li"},"fr"),"), it\u2019s necessary to create separate experiments, each targeting a single locale."),(0,i.yg)("li",{parentName:"ul"},"The process to request translations and retrieve translated content is completely manual.")),(0,i.yg)("p",null,"One of the benefits is that the request can be started before actually setting up the experiment in Experimenter."),(0,i.yg)("h3",{id:"request-translation-single-locale"},"Request Translation (Single-Locale)"),(0,i.yg)("p",null,"Once the content needed for the experiment is finalized, to initiate a translation request ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/mozilla-l10n/nimbus-l10n/issues/new?assignees=flodolo&template=new_translation.yaml"},"create a new issue here"),"."),(0,i.yg)("p",null,"For a description of fields shared with the multi-locale recipe request (",(0,i.yg)("em",{parentName:"p"},"Issue title"),", ",(0,i.yg)("em",{parentName:"p"},"Information about the experiment"),", ",(0,i.yg)("em",{parentName:"p"},"Deadline"),"), see the ",(0,i.yg)("a",{parentName:"p",href:"#request-translation"},"previous section"),"."),(0,i.yg)("h4",{id:"list-of-locales"},"List of Locales"),(0,i.yg)("p",null,"Provide the list of locales that need to be translated. Keep in mind that:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://mozilla-l10n.github.io/documentation/localization/globalization_best_practices.html#region--language"},"Locales are not regions"),". So, for example, French (fr) should be requested, not France."),(0,i.yg)("li",{parentName:"ul"},"Not all locales are supported. For example, our infrastructure supports a generic ",(0,i.yg)("inlineCode",{parentName:"li"},"French (fr)"),", but not ",(0,i.yg)("inlineCode",{parentName:"li"},"Canadian French (fr-CA)"),". In case, reach out to the ",(0,i.yg)("a",{parentName:"li",href:"https://mozilla-hub.atlassian.net/wiki/spaces/FDPDT/pages/11045331/Localization+l10n+and+Translation"},"Localization Team")," to clarify any doubts.")),(0,i.yg)("p",null,"Given the short turn-around for localization, we are currently limiting the requests to tier 1 locales (",(0,i.yg)("inlineCode",{parentName:"p"},"de"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"fr"),") \u2014 where we potentially also have internal copywriters as a backup \u2014 and locales that have internal staff available for support (",(0,i.yg)("inlineCode",{parentName:"p"},"it"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"ja"),")."),(0,i.yg)("h4",{id:"content-to-translate"},"Content to Translate"),(0,i.yg)("p",null,"If the experiment is small, it\u2019s possible to provide the content to translate directly in the issue. Alternatively, consider providing a link to a spreadsheet with one string per row, and 2 columns (one for the English text, one for comments or context) (an example is available ",(0,i.yg)("a",{parentName:"p",href:"https://docs.google.com/spreadsheets/d/11pIMJUxkiMELx-w6Czywy2ZRqCy2McUebnOT__yTU_Y/edit"},"here"),")."),(0,i.yg)("p",null,"If you\u2019re working with a developer already familiar with ",(0,i.yg)("a",{parentName:"p",href:"https://projectfluent.org/"},"Fluent"),", they can also help providing directly Fluent content with comments. Note that we only support a subset of features in experiments:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Only plain messages with a value, no attributes or variants (e.g. plurals)."),(0,i.yg)("li",{parentName:"ul"},"No terms or variables, so brand names like ",(0,i.yg)("inlineCode",{parentName:"li"},"Firefox")," need to be hard-coded in the text.")),(0,i.yg)("p",null,"Example of Fluent format:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"intro-message = Switch to Firefox Home with themed background\n# Button label that enables the theme\nintro-button-enable = Use background\n")),(0,i.yg)("h3",{id:"retrieve-translated-content-single-locale"},"Retrieve Translated Content (Single-Locale)"),(0,i.yg)("p",null,"Once translation has been completed, the requester will be notified in the original issue, with a link to a JSON file that includes all translations. The experiment owner will need to copy each translation manually in the experiment recipes."),(0,i.yg)("p",null,"The JSON file uses the following structure:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "complete": true,\n  "complete_locales": [\n    "de",\n    "en-US",\n    "fr",\n    "it"\n  ],\n  "translations": {\n    "en-US": {\n      "device-migration-fxa-spotlight-header": "Using an older device?",\n      "device-migration-fxa-spotlight-body": "Back up your data to make sure you don\u2019t lose important info like bookmarks and passwords \u2013\u2013 especially if you switch to a new device.",\n    },\n    "de": {\n      "device-migration-fxa-spotlight-header": "Verwenden Sie ein \xe4lteres Ger\xe4t?",\n      "device-migration-fxa-spotlight-body": "Sichern Sie Ihre Daten, um wichtige Informationen wie Lesezeichen und Passw\xf6rter nicht zu verlieren \u2013 insbesondere, wenn Sie zu einem neuen Ger\xe4t wechseln.",\n    },\n    "fr": {\n      "device-migration-fxa-spotlight-header": "Vous utilisez un appareil plus ancien ?",\n      "device-migration-fxa-spotlight-body": "Sauvegardez vos donn\xe9es pour vous assurer de ne pas perdre d\u2019informations importantes comme des marque-pages ou des mots de passe, surtout si vous changez d\u2019appareil.",\n    },\n    "it": {\n      "device-migration-fxa-spotlight-header": "Stai utilizzando un dispositivo meno recente?",\n      "device-migration-fxa-spotlight-body": "Salva i tuoi dati per non perdere informazioni importanti come segnalibri e password, soprattutto se hai in programma di passare a un nuovo dispositivo.",\n    }\n  }\n}\n')),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"complete"),": boolean field that indicates if the experiment has been translated in all requested locales."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"complete_locales"),": list of all locales completely translated."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"translations")," includes a key for each locale (e.g. ",(0,i.yg)("inlineCode",{parentName:"li"},"it")," for Italian), which in turns includes all pairs of unique message identifiers and translations. ",(0,i.yg)("inlineCode",{parentName:"li"},"en-US")," is also provided as a reference..")),(0,i.yg)("div",{className:"footnotes"},(0,i.yg)("hr",{parentName:"div"}),(0,i.yg)("ol",{parentName:"div"},(0,i.yg)("li",{parentName:"ol",id:"fn-1"},"Currently still in a testing phase.",(0,i.yg)("a",{parentName:"li",href:"#fnref-1",className:"footnote-backref"},"\u21a9")))))}u.isMDXComponent=!0}}]);