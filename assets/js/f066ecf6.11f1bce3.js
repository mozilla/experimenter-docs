"use strict";(self.webpackChunkexperimenter_docs=self.webpackChunkexperimenter_docs||[]).push([[8948],{4137:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),c=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(n),m=a,g=p["".concat(s,".").concat(m)]||p[m]||d[m]||i;return n?r.createElement(g,o(o({ref:t},u),{},{components:n})):r.createElement(g,o({ref:t},u))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:a,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9587:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var r=n(7462),a=(n(7294),n(4137));const i={id:"custom-audiences",title:"Advanced Targeting",sidebar_position:3},o=void 0,l={unversionedId:"workflow/implementing/custom-audiences",id:"workflow/implementing/custom-audiences",title:"Advanced Targeting",description:"Advanced Targeting let you target specific groups of users (or custom audience) beyond the regular targeting options. Advanced Targeting can be configured for any experiment through the experimenter UI:",source:"@site/docs/workflow/implementing/custom-audiences.md",sourceDirName:"workflow/implementing",slug:"/workflow/implementing/custom-audiences",permalink:"/workflow/implementing/custom-audiences",draft:!1,editUrl:"https://github.com/mozilla/experimenter-docs/edit/main/docs/workflow/implementing/custom-audiences.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{id:"custom-audiences",title:"Advanced Targeting",sidebar_position:3},sidebar:"sidebar",previous:{title:"Feature Definition",permalink:"/feature-definition"},next:{title:"Risk Mitigation",permalink:"/risk-mitigation"}},s={},c=[{value:"How to add new Advanced Targeting",id:"how-to-add-new-advanced-targeting",level:3},{value:"Sticky Targeting",id:"sticky-targeting",level:3}],u={toc:c},p="wrapper";function d(e){let{components:t,...i}=e;return(0,a.kt)(p,(0,r.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Advanced Targeting let you target specific groups of users (or custom audience) beyond the regular targeting options. Advanced Targeting can be configured for any experiment through the experimenter UI:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"advanced targeting screenshot",src:n(9514).Z,width:"740",height:"335"})),(0,a.kt)("p",null,"They are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Optional - Don't use them unless you need to limit the experiment to specific group of users."),(0,a.kt)("li",{parentName:"ul"},"Specific to a particular application (Not all audiences can target all applications)"),(0,a.kt)("li",{parentName:"ul"},"Evaluated on clients via an expression language (",(0,a.kt)("inlineCode",{parentName:"li"},"JEXL"),")")),(0,a.kt)("h3",{id:"how-to-add-new-advanced-targeting"},"How to add new Advanced Targeting"),(0,a.kt)("p",null,"Create a PR against ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/mozilla/experimenter/blob/main/experimenter/experimenter/targeting/constants.py"},"targeting/constants.py")," that adds a new JEXL expression.  There is a ",(0,a.kt)("a",{parentName:"p",href:"https://mozilla.hosted.panopto.com/Panopto/Pages/Viewer.aspx?id=8527feae-303e-41b3-b9df-b0a800f3cd41"},"recorded session showing 2 examples of adding advanced targeting")," to demoonstrate where to start."),(0,a.kt)("p",null,"Request review from a console core team member. It should be available in the Experimenter UI a few minutes after the PR has merged."),(0,a.kt)("p",null,"If you're an iOS or a Android developer check the following instructions for how to add new client-side targeting attributes:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/ios-custom-targeting"},"iOS")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/android-custom-targeting"},"Android"))),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"New Advanced Targeting should be tested by the Nimbus QA team before they are used in production. This could involve any or all of the following:"),(0,a.kt)("ul",{parentName:"admonition"},(0,a.kt)("li",{parentName:"ul"},"Test the whole JEXL expression on each application/device it is intended to run on."),(0,a.kt)("li",{parentName:"ul"},"Ask QA to help verify it by creating a dummy experiment."),(0,a.kt)("li",{parentName:"ul"},"Launch an A/A in nightly to see if real users enroll correctly"))),(0,a.kt)("h3",{id:"sticky-targeting"},"Sticky Targeting"),(0,a.kt)("p",null,"Every time Nimbus checks to see if there are new recipes or recipe ends - it checks that users still meet the targeting criteria for the recipes that they are already enrolled in.  "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"ex: it says enroll only US and you change countries to Germany - you no longer meet the targeting and will unenroll.  "),(0,a.kt)("li",{parentName:"ul"},"ex: it says max version 140 and you update to 141 - you no longer meet the targeting and will unenroll")),(0,a.kt)("p",null,'There are targeting cases where we want people to stay enrolled when they no longer meet the targeting criteria.   These are typically when the targeting criteria is based on time or a pref state.  We make that targeting "Sticky" - which means the targeting criteria is evaluated at the start, but not at each check-in.'),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"ex: it says enroll new users with less that 7 days old profile - on day 8 we want users to stay enrolled.  We make the targeting Sticky so they stay in day 8 and beyond."),(0,a.kt)("li",{parentName:"ul"},"ex: it says enroll only people without a certain feature - we promote the feature to only those people.  We make the targeting Sticky so they stay enrolled even if they use the feature.")))}d.isMDXComponent=!0},9514:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/custom-audiences-2fc4ce5ad8b55ca5060c6863bcafb81f.png"}}]);