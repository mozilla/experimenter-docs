"use strict";(self.webpackChunkexperimenter_docs=self.webpackChunkexperimenter_docs||[]).push([[8321],{4137:(e,t,i)=>{i.d(t,{Zo:()=>p,kt:()=>d});var a=i(7294);function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t){if(null==e)return{};var i,a,r=function(e,t){if(null==e)return{};var i,a,r={},n=Object.keys(e);for(a=0;a<n.length;a++)i=n[a],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)i=n[a],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var l=a.createContext({}),u=function(e){var t=a.useContext(l),i=t;return e&&(i="function"==typeof e?e(t):s(s({},t),e)),i},p=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},m="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var i=e.components,r=e.mdxType,n=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=u(i),c=r,d=m["".concat(l,".").concat(c)]||m[c]||h[c]||n;return i?a.createElement(d,s(s({ref:t},p),{},{components:i})):a.createElement(d,s({ref:t},p))}));function d(e,t){var i=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var n=i.length,s=new Array(n);s[0]=c;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[m]="string"==typeof e?e:r,s[1]=o;for(var u=2;u<n;u++)s[u]=i[u];return a.createElement.apply(null,s)}return a.createElement.apply(null,i)}c.displayName="MDXCreateElement"},9740:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>n,metadata:()=>o,toc:()=>u});var a=i(7462),r=(i(7294),i(4137));const n={id:"sizing",title:"Population Sizing",slug:"/sizing"},s="How large should my experiment be?",o={unversionedId:"deep-dives/data/sizing",id:"deep-dives/data/sizing",title:"Population Sizing",description:"When running experiments, choosing the right size is essential to balance getting meaningful results with minimizing the risk of exposing a larger user population to a potentially negative treatment.",source:"@site/docs/deep-dives/data/sizing.md",sourceDirName:"deep-dives/data",slug:"/sizing",permalink:"/sizing",draft:!1,editUrl:"https://github.com/mozilla/experimenter-docs/edit/main/docs/deep-dives/data/sizing.md",tags:[],version:"current",frontMatter:{id:"sizing",title:"Population Sizing",slug:"/sizing"},sidebar:"sidebar",previous:{title:"Preenrollment Bias",permalink:"/preenrollment-bias"},next:{title:"Desktop Local Experiment Iteration",permalink:"/desktop-enroll-locally"}},l={},u=[{value:"Statistical Power",id:"statistical-power",level:2},{value:"Commentary on Absolute Size",id:"commentary-on-absolute-size",level:3},{value:"Commentary on Exposure Rates",id:"commentary-on-exposure-rates",level:3},{value:"Understand Sizing Drivers",id:"understand-sizing-drivers",level:2},{value:"Learning Goal",id:"learning-goal",level:3},{value:"Helpful Design Patterns",id:"helpful-design-patterns",level:2},{value:"Sequentially Larger",id:"sequentially-larger",level:3},{value:"Exploratory then Explanatory",id:"exploratory-then-explanatory",level:3},{value:"Smoke Test",id:"smoke-test",level:3},{value:"Same design, more insights",id:"same-design-more-insights",level:2},{value:"Validate Causal Hypothesis",id:"validate-causal-hypothesis",level:3},{value:"Frequently Asked Questions",id:"frequently-asked-questions",level:2},{value:"Q: I&#39;m concerned that the proposed size might not be large enough to measure statistical significance. Or equivalently: I ran an experiment and the results were not stat sig, what can I do?",id:"q-im-concerned-that-the-proposed-size-might-not-be-large-enough-to-measure-statistical-significance-or-equivalently-i-ran-an-experiment-and-the-results-were-not-stat-sig-what-can-i-do",level:3},{value:"Q: very few users are expected to be exposed to/interact with my experiment.",id:"q-very-few-users-are-expected-to-be-exposed-tointeract-with-my-experiment",level:3},{value:"Q: my experiment is very risky, what should I do?",id:"q-my-experiment-is-very-risky-what-should-i-do",level:3},{value:"Q: I have a lot of variants, I&#39;m not sure which will be the best, and I want to maximize the ability to measure impact.",id:"q-i-have-a-lot-of-variants-im-not-sure-which-will-be-the-best-and-i-want-to-maximize-the-ability-to-measure-impact",level:3},{value:"Q: I don&#39;t know how many users will interact or be exposed.",id:"q-i-dont-know-how-many-users-will-interact-or-be-exposed",level:3},{value:"Q: My experiment is low risk and I need to maximize potential achieved value and realize value quickly.",id:"q-my-experiment-is-low-risk-and-i-need-to-maximize-potential-achieved-value-and-realize-value-quickly",level:3},{value:"Q: I&#39;ve read all of this, my experiment is quite low risk, I mostly care about measuring potential value (positive impacts) to guardrails, there aren&#39;t any special considerations, I just need to get a number and you&#39;re blocking me.",id:"q-ive-read-all-of-this-my-experiment-is-quite-low-risk-i-mostly-care-about-measuring-potential-value-positive-impacts-to-guardrails-there-arent-any-special-considerations-i-just-need-to-get-a-number-and-youre-blocking-me",level:3}],p={toc:u},m="wrapper";function h(e){let{components:t,...i}=e;return(0,r.kt)(m,(0,a.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"how-large-should-my-experiment-be"},"How large should my experiment be?"),(0,r.kt)("p",null,"When running experiments, choosing the right size is essential to balance getting meaningful results with minimizing the risk of exposing a larger user population to a potentially negative treatment."),(0,r.kt)("p",null,"If the experiment is too small, you risk missing important effects or obtaining inconclusive results (but expose fewer users to the treatment). If the experiment is too large, more information may be gained from the results, but the risk due to a negative impact of a branch is excessively large."),(0,r.kt)("h2",{id:"statistical-power"},"Statistical Power"),(0,r.kt)("p",null,"Statistical power is the probability that the experiment measures a stat sig impact, given that such an impact really exists (",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Power_(statistics)"},"ref"),"). It is a function of the analysis (metric & statistical test), the design (number of branches), the number of users in the experiment, and the size of the effect."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"For a given effect size, more users will give a higher power."),(0,r.kt)("li",{parentName:"ul"},"For a given branch volume, larger impacts are easier to measure (higher power) than smaller impacts."),(0,r.kt)("li",{parentName:"ul"},"For a given total experiment size, more branches will reduce the statistical power.")),(0,r.kt)("p",null,'We often talk about the "minimum effect size" (MES) as the smallest impact that we care about. A good guideline is to aim for a power of at least 80% for the MES (as that would give us an 80% chance of detecting the MES if it exists and a higher power of detecting larger effects).'),(0,r.kt)("h3",{id:"commentary-on-absolute-size"},"Commentary on Absolute Size"),(0,r.kt)("p",null,"Statistical power generally (for the statistical tests that Jetstream performs) scales proportionally to the square root of the number of users. As a result, the power gains from increasing the size of an experiment depend on the actual size being considered. That is to say that going from 1% -> 2% has a much larger impact on the power than going from 9% -> 10%. One corollary of this is that, as a general rule, the power gains of going beyond 10% of users per branch are rather minimal. Generally, a 20% experiment (10%/branch) has only slightly lower power than a 100% experiment. There are of course exceptions depending on the absolute size of the targeted population, the smaller the targeted population, the less this rule applies."),(0,r.kt)("h3",{id:"commentary-on-exposure-rates"},"Commentary on Exposure Rates"),(0,r.kt)("p",null,"Experiments often have 2 goals: 1) to measure the impact on users exposed to the treatment and 2) to quantify the impact on business KPIs. The exposure rate (% of enrolled clients who actually saw the treatment) affects both of these considerations. The exposure funnel proportionally reduces the number of users in the sample, thus reducing the power. Similarly, the smaller the exposure rate, the higher an impact on exposed users would be required to move business KPIs. One corollary to this is that risk is proportionally reduced. As an example, for a 1% exposure rate, we can run a much larger experiment for a given risk level (absolute number of users exposed). If exposure rates are very low, opportunity size is low but so is risk."),(0,r.kt)("h2",{id:"understand-sizing-drivers"},"Understand Sizing Drivers"),(0,r.kt)("p",null,"There are often important business considerations which can effect the choice of sizing. These can include:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Learning Goal"),(0,r.kt)("li",{parentName:"ol"},"Risks"),(0,r.kt)("li",{parentName:"ol"},"Opportunity size"),(0,r.kt)("li",{parentName:"ol"},"Prioritization"),(0,r.kt)("li",{parentName:"ol"},"Contractual requirements")),(0,r.kt)("p",null,"In many situations, these concerns dwarf statistical considerations."),(0,r.kt)("h3",{id:"learning-goal"},"Learning Goal"),(0,r.kt)("p",null,"What is the goal of the experiment?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Measure realized value, if any, from a low risk, high priority feature release. In this case, we can choose a large size or even consider a holdback design."),(0,r.kt)("li",{parentName:"ul"},"Determine opportunity size. In this case, we can run a small experiment to assess the opportunity size (exposure rate)."),(0,r.kt)("li",{parentName:"ul"},"Demonstrate feature viability. In this case, statistical power is important, but we can also consider staged designs (see below) which maximize precision while reducing risk, at the expense of additional time/effort. We should strongly consider looking at upstream metrics to validate the causal hypothesis."),(0,r.kt)("li",{parentName:"ul"},"Prove a positive impact on guardrail metrics. In this case, a large experiment may be required.")),(0,r.kt)("h2",{id:"helpful-design-patterns"},"Helpful Design Patterns"),(0,r.kt)("p",null,"In this section we introduce a few ways to string together sequences of experiments for various beneficial outcomes such as reducing risk or maximizing realized value."),(0,r.kt)("h3",{id:"sequentially-larger"},"Sequentially Larger"),(0,r.kt)("p",null,"In this pattern, we can run a sequence of experiments (2 or more) of increasing size. Some examples include:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"A small experiment (<5%) followed by a very large experiment (20%-100%).",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Risk is mitigated by running a small experiment (which will bound potential negative impacts) before exposing a large portion of users."),(0,r.kt)("li",{parentName:"ul"},"Statistical power is maximalized by the very large experiment, giving the highest chance of measuring an impact."))),(0,r.kt)("li",{parentName:"ol"},"A very small experiment (<1%), followed by a small experiment (<5%), followed by a very large experiment.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Similar to above, but further limits the risk of the 5% experiment through the use of a very small, preliminary experiment. See for example the ",(0,r.kt)("a",{parentName:"li",href:"https://docs.google.com/presentation/d/1vTRx6kv3oAvIZSNcle6YhhMTQ8_5nLn77PNqCFuAQc8/edit#slide=id.g32cf211b9a1_3_92"},"rollout of ToU")," which used a 4-stage design.")))),(0,r.kt)("h3",{id:"exploratory-then-explanatory"},"Exploratory then Explanatory"),(0,r.kt)("p",null,"In this pattern, we run an initial small experiment with many branches to identify the winning variant (using a more sensitive, experiment or feature specific metric) and follow-up with a larger experiment to maximize the power of measuring guardrail impacts. For example:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"A 10% experiment split into 5 branches (2%/branch) followed by a 2-branch 50% experiment (25%/branch).",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"The initial experiment can choose the winner using a sensitive, design-specific message (e.g., clicks on a promotional message or an upstream usage metric)."),(0,r.kt)("li",{parentName:"ul"},"The follow-on experiment maximizes the power of measuring guardrail impacts."),(0,r.kt)("li",{parentName:"ul"},"Opportunity cost and risk is minimized compared to a single very large design (fewer users exposed to sub-optimial variants) with equivalent power.")))),(0,r.kt)("h3",{id:"smoke-test"},"Smoke Test"),(0,r.kt)("p",null,"In this pattern, a very small experiment (~1% or so) is run prior to the main experiment. This can estimate opportunity size/exposure rates and derisk a larger experiment. This is a special form of the Sequentially Larger pattern."),(0,r.kt)("h2",{id:"same-design-more-insights"},"Same design, more insights"),(0,r.kt)("p",null,"In this section, we explore methods to increase the learnings from a given design."),(0,r.kt)("h3",{id:"validate-causal-hypothesis"},"Validate Causal Hypothesis"),(0,r.kt)("p",null,'Most experiments have a "Causal Hypothesis", a directed graph of variables whereby causality flows from the action we take in the experiment through toward the outcome we want to measure. As a simple example, suppose we\'re building a new feature that we believe users will find valuable. The hypothesis could be: if I promote the feature through a message, users will try out the feature and gain value from the feature, and subsequently return to use the browser more. Graphically, the hypothesis is: promotion -> use feature -> higher retention.'),(0,r.kt)("p",null,"Retention (down funnel) is difficult to move, but metrics up funnel are easier to move. We can go one step up and measure feature usage (more sensitive than retention) or even message interaction (most sensitive). Even if a given experiment fails to measure impact to retention, if we can demonstrate impact to upstream metrics then we still have learnings."),(0,r.kt)("h2",{id:"frequently-asked-questions"},"Frequently Asked Questions"),(0,r.kt)("h3",{id:"q-im-concerned-that-the-proposed-size-might-not-be-large-enough-to-measure-statistical-significance-or-equivalently-i-ran-an-experiment-and-the-results-were-not-stat-sig-what-can-i-do"},"Q: I'm concerned that the proposed size might not be large enough to measure statistical significance. Or equivalently: I ran an experiment and the results were not stat sig, what can I do?"),(0,r.kt)("p",null,"A: you can follow-on with a larger experiment, now that the variant has been de-risked."),(0,r.kt)("h3",{id:"q-very-few-users-are-expected-to-be-exposed-tointeract-with-my-experiment"},"Q: very few users are expected to be exposed to/interact with my experiment."),(0,r.kt)("p",null,"A: in that case, the risk is also low. You may need to run a large experiment (up to even enrolling all users who meet a criteria) in order to measure any impacts. Also consider the opportunity size though: if very few users could benefit from the experiment that limits the potential value."),(0,r.kt)("h3",{id:"q-my-experiment-is-very-risky-what-should-i-do"},"Q: my experiment is very risky, what should I do?"),(0,r.kt)("p",null,"A: run a staged design, with the number of stages and the sizes influenced by the level of risk."),(0,r.kt)("h3",{id:"q-i-have-a-lot-of-variants-im-not-sure-which-will-be-the-best-and-i-want-to-maximize-the-ability-to-measure-impact"},"Q: I have a lot of variants, I'm not sure which will be the best, and I want to maximize the ability to measure impact."),(0,r.kt)("p",null,"A: consider the Exploratory then Explanatory design mentioned above."),(0,r.kt)("h3",{id:"q-i-dont-know-how-many-users-will-interact-or-be-exposed"},"Q: I don't know how many users will interact or be exposed."),(0,r.kt)("p",null,"A: follow the Smoke Test pattern."),(0,r.kt)("h3",{id:"q-my-experiment-is-low-risk-and-i-need-to-maximize-potential-achieved-value-and-realize-value-quickly"},"Q: My experiment is low risk and I need to maximize potential achieved value and realize value quickly."),(0,r.kt)("p",null,"A: Consider the Holdback Pattern where you hold 1%-10% of users back as control and deliver the feature the remaining 90%-99%."),(0,r.kt)("h3",{id:"q-ive-read-all-of-this-my-experiment-is-quite-low-risk-i-mostly-care-about-measuring-potential-value-positive-impacts-to-guardrails-there-arent-any-special-considerations-i-just-need-to-get-a-number-and-youre-blocking-me"},"Q: I've read all of this, my experiment is quite low risk, I mostly care about measuring potential value (positive impacts) to guardrails, there aren't any special considerations, I just need to get a number and you're blocking me."),(0,r.kt)("p",null,"A: pick a size in the range of 1%-10% per branch, depending on your personal risk tolerance. Consider following up with a secondary experiment if results from the first are inconclusive."))}h.isMDXComponent=!0}}]);