<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="search" type="application/opensearchdescription+xml" title="Experimenter Docs" href="/opensearch.xml"><title data-react-helmet="true">Feature Manifest Language Front-end Format As YAML | Experimenter Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://experimenter.info/fml-front-end-format"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Feature Manifest Language Front-end Format As YAML | Experimenter Docs"><meta data-react-helmet="true" name="description" content="- Status: accepted"><meta data-react-helmet="true" property="og:description" content="- Status: accepted"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://experimenter.info/fml-front-end-format"><link data-react-helmet="true" rel="alternate" href="https://experimenter.info/fml-front-end-format" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://experimenter.info/fml-front-end-format" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.b23d1bbe.css">
<link rel="preload" href="/assets/js/runtime~main.8c571f26.js" as="script">
<link rel="preload" href="/assets/js/main.98ae09e3.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Experimenter Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-dark.svg" alt="Experimenter Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Experimenter Docs</b></a></div><div class="navbar__items navbar__items--right"><a href="https://experimenter.services.mozilla.com/nimbus/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Nimbus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://mana.mozilla.org/wiki/display/FJT/Project+Nimbus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Mana<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/mozilla/experimenter-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Feature Manifest Language Front-end Format As YAML</h1></header><ul><li>Status: accepted</li><li>Deciders: @travis79, @jhugman, @teshaq, @k88hudson</li><li>Date: 2021-10-26</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="context-and-problem-statement"></a>Context and problem statement<a class="hash-link" href="#context-and-problem-statement" title="Direct link to heading">#</a></h2><p>In order to allow product teams to define experimentable application features, there needs to be a manifest file which defines these in a way that is understandable to the Nimbus ecosystem.  The feature manifest should define data types used in the application code to configure features. It should also be able to define a complete default configuration for each application feature.</p><p>The purpose of this document is to define the decision on the format of the feature manifest but not be a full specification of the schema or language of it.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="decision-drivers"></a>Decision drivers<a class="hash-link" href="#decision-drivers" title="Direct link to heading">#</a></h2><ul><li>It should not be onerous to write and maintain for a junior engineer or intern</li><li>A single feature should be readable/guessable by a product owner or designer</li><li>Once written, it should be easy to navigate and read, even if there are many features</li><li>It should map easily to Kotlin, Swift (and Rust)</li><li>No algebraic types</li><li>No inheritance / polymorphism</li><li>Defaults should be specifiable at the property level</li><li>Defaults should be specifiable at the feature level</li><li>Alignment with Desktop Nimbus which is already using a feature manifest, in the hopes that the schema can be shared between mobile and desktop eventually</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="decision-outcome"></a>Decision outcome<a class="hash-link" href="#decision-outcome" title="Direct link to heading">#</a></h2><p>The front-end format for the Nimbus manifests will follow the <a href="https://yaml.org/" target="_blank" rel="noopener noreferrer">YAML</a> format.</p><p>Pros:</p><ul><li>More concise, and less likely to have errors due to formatting such as missing a bracket or comma</li><li>Support for comments within the document</li><li>A schema can be defined using JSONSchema for the purposes of validation</li><li>YAML is a superset of JSON, so any existing JSON should be able to be parsed by the YAML parser</li><li>JSON can be embedded within YAML</li><li>Support for multiple documents within one file, so each feature could be a separate &quot;document&quot;, simplifying and flattening the schema</li><li>Ease of migration for Desktop from JavaScript objects to YAML objects</li></ul><p>Cons:</p><ul><li>Yet another data representation language to deal with</li><li>Readability over other formats is marginal</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="examples"></a>Examples<a class="hash-link" href="#examples" title="Direct link to heading">#</a></h2><p>To illustrate the YAML format, here is an example of the &quot;homescreen&quot; feature, first in JSON, then the same representation in YAML.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="json-example"></a>JSON Example<a class="hash-link" href="#json-example" title="Direct link to heading">#</a></h3><p>This example is only intended to illustrate the structure of the data, and not serve as an example of the suggested format. See the YAML example below for the suggested format.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly JSON"><pre tabindex="0" class="prism-code language-JSON codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;enums&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot;: &quot;SectionId&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;doc&quot;: &quot;The sections of the homescreen&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;variants&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot;: &quot;top-sites&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;doc&quot;: &quot;The original frecency sorted sites&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot;: &quot;jump-back-in&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;doc&quot;: &quot;Jump back in section&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot;: &quot;recently-saved&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;doc&quot;: &quot;Tabs that have been bookmarked recently&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      ]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;objects&quot;: [],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;hints&quot;: {},</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;features&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;name&quot;: &quot;homescreen&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;doc&quot;: &quot;Represents the homescreen feature&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;props&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;name&quot;: &quot;sections-enabled&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;doc&quot;: &quot;A map of booleans&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;type&quot;: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;EnumMap&quot;: [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;Enum&quot;: &quot;HomeScreenSection&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              &quot;Boolean&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          },</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;default&quot;: {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;jump-back-in&quot;: false,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;recently-saved&quot;: false,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;top-sites&quot;: true</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      ],</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;default&quot;: null</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  ]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="yaml-example"></a>YAML Example<a class="hash-link" href="#yaml-example" title="Direct link to heading">#</a></h3><p>This example is meant to illustrate the concise format and readability of YAML.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly YAML"><pre tabindex="0" class="prism-code language-YAML codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">---</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Define your enumerations here</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">enums:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  SectionId:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    description: The sections of the homescreen</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    variants:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      top-sites:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        description: The original frecency sorted sites</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      jump-back-in:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        description: Jump back in section</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      recently-saved:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        description: Tabs that have been bookmarked recently</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Define your features here</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">features:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  homescreen:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    description: Represents the homescreen feature</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    variables:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      sections-enabled:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        description: A map of booleans</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        variable_type: Map&lt;Enum(SectionId), Boolean&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        default: |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          [</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;top-sites&quot;: &quot;true&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;jump-back-in&quot;: &quot;false&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;recently-saved&quot;: &quot;false&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          ]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    default: ~</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="other-considered-options"></a>Other considered options<a class="hash-link" href="#other-considered-options" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="option-1---json"></a>Option 1 - JSON<a class="hash-link" href="#option-1---json" title="Direct link to heading">#</a></h3><p>JSON is still technically supported since YAML is a superset of JSON.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="option-2---javascripttypescript"></a>Option 2 - JavaScript/TypeScript<a class="hash-link" href="#option-2---javascripttypescript" title="Direct link to heading">#</a></h3><p>JavaScript and TypeScript parser crates are harder to find and appear less supported in Rust, and using a full-blown javascript engine seems like overkill.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="additional-considerations"></a>Additional considerations<a class="hash-link" href="#additional-considerations" title="Direct link to heading">#</a></h2><ul><li>It should be easy to copy a winning branch of an experiment or rollout back into the feature manifest</li><li>Reference to bundled text and icons should allow for multiple choice in the manifest</li><li>An app may consist of multiple projects</li><li>The format/schema/grammar of the feature manifest language should be documented in the nimbus-shared repo</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/mozilla/experimenter-docs/edit/main/docs/fml-front-end-format.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#context-and-problem-statement" class="table-of-contents__link">Context and problem statement</a></li><li><a href="#decision-drivers" class="table-of-contents__link">Decision drivers</a></li><li><a href="#decision-outcome" class="table-of-contents__link">Decision outcome</a></li><li><a href="#examples" class="table-of-contents__link">Examples</a><ul><li><a href="#json-example" class="table-of-contents__link">JSON Example</a></li><li><a href="#yaml-example" class="table-of-contents__link">YAML Example</a></li></ul></li><li><a href="#other-considered-options" class="table-of-contents__link">Other considered options</a><ul><li><a href="#option-1---json" class="table-of-contents__link">Option 1 - JSON</a></li><li><a href="#option-2---javascripttypescript" class="table-of-contents__link">Option 2 - JavaScript/TypeScript</a></li></ul></li><li><a href="#additional-considerations" class="table-of-contents__link">Additional considerations</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Mozilla Corporation</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8c571f26.js"></script>
<script src="/assets/js/main.98ae09e3.js"></script>
</body>
</html>